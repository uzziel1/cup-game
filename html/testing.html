<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />

    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0 maximum-scale=1.0 user-scalable = 0"
    />
    <title>Cup Game</title>
    <link rel="icon" href="../imgs/cup-game-icon.png" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Hubballi&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../css/index.css" />
    <link rel="stylesheet" href="../css/loading.css" />
    <link rel="stylesheet" href="../css/test.css" />
  </head>
  <body>
    <div class="main">
      <div class="scores">
        <div class="game-current-score" id="display">
          Current score: 00:00.00
        </div>
        <div class="game-high-score" id="high-score">High score: 00:00.00</div>
      </div>

      <div class="settings-cog" id="settings-cog">
        <img src="../imgs/Settings-cog.png" />
      </div>

      <div class="table-group">
        <div class="cup-container">
          <img
            id="red"
            class="cup"
            src="../imgs/cup-colors/shravani-cup.png"
            alt="Red Cup"
            draggable="true"
          />
          <img
            id="orange"
            class="cup"
            src="../imgs/cup-colors/shayla-cup.png"
            alt="Orange Cup"
            draggable="true"
          />
          <img
            id="yellow"
            class="cup"
            src="../imgs/cup-colors/jaime-cup.png"
            alt="Yellow Cup"
            draggable="true"
          />
          <img
            id="green"
            class="cup"
            src="../imgs/cup-colors/addison-cup.png"
            alt="Green Cup"
            draggable="true"
          />
          <img
            id="blue"
            class="cup"
            src="../imgs/cup-colors/jennifer-cup.png"
            alt="Blue Cup"
            draggable="true"
          />
          <img
            id="purple"
            class="cup"
            src="../imgs/cup-colors/vibrant-red-cup.png"
            alt="Purple Cup"
            draggable="true"
          />
          <img
            id="pink"
            class="cup"
            src="../imgs/cup-colors/white-cup.png "
            alt="Pink Cup"
            draggable="true"
          />
        </div>
        <div class="table"><img src="../imgs/table.png" /></div>
      </div>
      <div class="play">Shuffling Cups...</div>

      <div class="settings-container" id="settings-modal">
        <div class="settings-top-bar">
          <div class="settings-header">Settings</div>
          <img id="settings-exit-btn" src="../imgs/exit-button.png" />
        </div>
        <div class="settings-toggles">
          <div class="music-row">
            <div class="music-header">Music</div>
            <div class="settings-spacer"></div>
            <button class="music-toggle" id="music-toggle"></button>
          </div>
          <div class="bg-color-row">
            <div class="bg-color-header">BG Color</div>
            <div class="settings-spacer"></div>
            <button class="bg-color-toggle" id="bg-color-toggle"></button>
          </div>
          <div class="cup-mode-row">
            <div class="cup-mode-header">Cup Mode</div>
            <div class="settings-spacer"></div>
            <button class="cup-mode-toggle">Pastel</button>
          </div>
        </div>
        <div class="settings-bottom-bar">
          <button class="main-menu-button">Main Menu</button>
          <button class="play-button">
            <img style="width: 1rem" src="../imgs/play-button.png" />
          </button>
        </div>
      </div>
    </div>
  </body>
  <script>
    const settingsModal = document.getElementById('settings-modal');
    const settingsCog = document.getElementById('settings-cog');
    const closeSettings = document.getElementById('settings-exit-btn');
    const musicToggle = document.getElementById('music-toggle');
    const bgColorToggle = document.getElementById('bg-color-toggle');

    let music = new Audio('../music/savage-funk.mp3');
    const buttonGreenColor = '#bcff96';
    const buttonRedColor = '#ff6a6e';

    //purple, green, blue, orange, pink, red, yellow,
    bgColorOptions = [
      '#eaddff',
      '#e2ffdd',
      '#c9f0ff',
      '#ffceb9',
      '#ffccff',
      '#f78f8f',
      '#f4da90',
      '#ffffff',
    ];
    cupColorOptions = [
      'pastel',
      'vibrant',
      'earth',
      'monochrome',
      'neon',
      'dark',
      'muted',
    ];
    let bgColorIndex = JSON.parse(localStorage.getItem('bgColorIndex')) || 0;
    let musicOn = localStorage.getItem('musicOn') === 'true'; // Convert to boolean

    // Set initial background color based on musicOn
    if (musicOn) {
      musicToggle.style.backgroundColor = buttonGreenColor;
      music.play();
    } else {
      musicToggle.style.backgroundColor = buttonRedColor;
    }

    document.body.style.backgroundColor = bgColorOptions[bgColorIndex];
    bgColorToggle.style.backgroundColor = bgColorOptions[bgColorIndex];

    settingsCog.onclick = function () {
      settingsModal.style.display = 'block';
    };

    closeSettings.onclick = function () {
      settingsModal.style.display = 'none';
    };

    //Setting Buttons
    musicToggle.onclick = function () {
      if (musicOn) {
        musicOn = false;
        musicToggle.style.backgroundColor = buttonRedColor;
        music.pause();
        localStorage.setItem('musicOn', 'false');
      } else {
        musicOn = true;
        musicToggle.style.backgroundColor = buttonGreenColor;
        music.play();
        localStorage.setItem('musicOn', 'true');
      }
    };

    bgColorToggle.onclick = function () {
      bgColorIndex = (bgColorIndex + 1) % bgColorOptions.length;
      document.body.style.backgroundColor = bgColorOptions[bgColorIndex];
      bgColorToggle.style.backgroundColor = bgColorOptions[bgColorIndex];

      localStorage.setItem('bgColorIndex', bgColorIndex);
    };
  </script>
</html>
